var z=Object.defineProperty,$=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var C=(r,a,l)=>a in r?z(r,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[a]=l,v=(r,a)=>{for(var l in a||(a={}))S.call(a,l)&&C(r,l,a[l]);if(h)for(var l of h(a))D.call(a,l)&&C(r,l,a[l]);return r},k=(r,a)=>$(r,B(a));var _=(r,a)=>{var l={};for(var n in r)S.call(r,n)&&a.indexOf(n)<0&&(l[n]=r[n]);if(r!=null&&h)for(var n of h(r))a.indexOf(n)<0&&D.call(r,n)&&(l[n]=r[n]);return l};import{d as H,u as Q,r as i,i as F,j as e,C as V}from"./index-BXN-gaEy.js";import{E as J}from"./EventCard-Smhp_CKP.js";import{S as U}from"./SearchBar-WR6MAao9.js";import{s as q}from"./slug-Be7lxzw5.js";import"./vendor-firebase-CLtQg3ae.js";const y=9,G=[{value:"newest",label:"Newest First"},{value:"date_asc",label:"Date: Upcoming First"},{value:"date_desc",label:"Date: Latest First"},{value:"price_low",label:"Price: Low to High"},{value:"price_high",label:"Price: High to Low"}],W=["All Categories","Education","Workshop","Seminar","Competition","Other"],ae=()=>{const{tuitionInstitutes:r,teachers:a}=H(),{handleNavigate:l}=Q(),[n,P]=i.useState(""),[x,M]=i.useState("date_asc"),[d,L]=i.useState("all"),[p,j]=i.useState(y),f=i.useRef(!1),w=i.useRef(null),O=s=>l({name:"event_detail_slug",slug:q(s.title)}),T=()=>l({name:"home"}),g=i.useMemo(()=>{const s=r.flatMap(t=>(t.events||[]).map(o=>k(v({},o),{organizer:t}))),c=a.flatMap(t=>(t.events||[]).map(o=>k(v({},o),{organizer:t}))),m=[...s,...c];return console.log("AllEventsPage Debug Details JSON:",JSON.stringify(m.map(t=>({title:t.title,isPublished:t.isPublished,status:t.status,dynamicStatus:F(t),start:`${t.startDate} ${t.startTime}`,end:`${t.endDate} ${t.endTime}`})),null,2)),[...m.filter(t=>{const o=t.isPublished,A=t.status==="canceled",I=F(t)==="finished";if(!o||A||I)return!1;if(n.trim()){const R=n.toLowerCase();if(![t.title,t.description,t.organizer.name,t.category].join(" ").toLowerCase().includes(R))return!1}return!(d!=="all"&&t.category!==d)})].sort((t,o)=>{switch(x){case"newest":return o.id.localeCompare(t.id);case"date_desc":return new Date(o.startDate).getTime()-new Date(t.startDate).getTime();case"price_high":return o.tickets.price-t.tickets.price;case"price_low":return t.tickets.price-o.tickets.price;case"date_asc":default:return new Date(t.startDate).getTime()-new Date(o.startDate).getTime()}})},[r,n,x,d]);i.useEffect(()=>{j(y)},[n,x,d]);const u=i.useMemo(()=>g.slice(0,p),[g,p]),N=i.useCallback(s=>{s[0].isIntersecting&&!f.current&&(f.current=!0,j(m=>m+y))},[]);i.useEffect(()=>{f.current=!1},[p]),i.useEffect(()=>{const s=new IntersectionObserver(N,{root:null,rootMargin:"200px",threshold:0}),c=w.current;return c&&s.observe(c),()=>{c&&s.unobserve(c)}},[N,u]);const E=r.flatMap(s=>s.events||[]).length+a.flatMap(s=>s.events||[]).length;return e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-slideInUp",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("button",{onClick:T,className:"flex items-center space-x-2 text-sm font-medium text-primary hover:text-primary-dark transition-colors",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{children:"Back to Home"})]})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Explore All Events"}),e.jsx("p",{className:"mt-2 text-lg text-light-subtle dark:text-dark-subtle",children:"Find exciting educational events happening online and near you."})]}),e.jsx("div",{className:"sticky top-16 z-20 py-4 bg-light-background/80 dark:bg-dark-background/80 backdrop-blur-sm -mx-4 sm:px-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 mb-8",children:e.jsxs("div",{className:"max-w-5xl mx-auto space-y-4",children:[e.jsx(U,{searchQuery:n,setSearchQuery:P}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-events",className:"block text-sm font-medium text-light-text dark:text-dark-text mb-1",children:"Sort by"}),e.jsx("select",{id:"sort-events",value:x,onChange:s=>M(s.target.value),className:"w-full px-3 py-2 border border-light-border dark:border-dark-border text-light-text dark:text-dark-text bg-light-surface dark:bg-dark-surface rounded-md focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",children:G.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-category",className:"block text-sm font-medium text-light-text dark:text-dark-text mb-1",children:"Category"}),e.jsxs("select",{id:"filter-category",value:d,onChange:s=>L(s.target.value),className:"w-full px-3 py-2 border border-light-border dark:border-dark-border text-light-text dark:text-dark-text bg-light-surface dark:bg-dark-surface rounded-md focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",children:[e.jsx("option",{value:"all",children:"All Categories"}),W.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})]})}),u.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-light-subtle dark:text-dark-subtle mb-6",children:["Showing ",u.length," of ",g.length," events."]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:u.map(m=>{var b=m,{organizer:s}=b,c=_(b,["organizer"]);return e.jsx(J,{event:c,organizer:s,onView:O},c.id)})}),u.length<g.length&&e.jsx("div",{ref:w,className:"flex justify-center items-center h-20",children:e.jsx("div",{className:"w-8 h-8 border-4 border-dashed rounded-full animate-spin border-primary"})})]}):e.jsxs("div",{className:"text-center py-16 text-light-subtle dark:text-dark-subtle",children:[e.jsx("p",{className:"text-xl font-semibold",children:"No events found"}),e.jsx("p",{children:"Try adjusting your search query or filters."}),E>0&&e.jsxs("p",{className:"mt-4 text-yellow-600 dark:text-yellow-400 text-sm",children:["Debug: Found ",E," raw events, but all were hidden. Check console for details."]})]})]})};export{ae as default};
