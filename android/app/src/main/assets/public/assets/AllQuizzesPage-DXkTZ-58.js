var T=Object.defineProperty,A=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var y=(r,a,l)=>a in r?T(r,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[a]=l,C=(r,a)=>{for(var l in a||(a={}))N.call(a,l)&&y(r,l,a[l]);if(g)for(var l of g(a))S.call(a,l)&&y(r,l,a[l]);return r},F=(r,a)=>A(r,O(a));var Q=(r,a)=>{var l={};for(var o in r)N.call(r,o)&&a.indexOf(o)<0&&(l[o]=r[o]);if(r!=null&&g)for(var o of g(r))a.indexOf(o)<0&&S.call(r,o)&&(l[o]=r[o]);return l};import{d as D,u as P,b as R,r as i,h as B,j as e,C as H}from"./index-BXN-gaEy.js";import{Q as V}from"./QuizCard-COBKBKhv.js";import{S as U}from"./SearchBar-WR6MAao9.js";import{s as $}from"./slug-Be7lxzw5.js";import"./vendor-firebase-CLtQg3ae.js";import"./StarRating-BeOC4AZb.js";const v=9,G=[{value:"newest",label:"Newest First"},{value:"oldest",label:"Oldest First"},{value:"date",label:"Date"},{value:"fee_low",label:"Fee: Low to High"},{value:"fee_high",label:"Fee: High to Low"}],se=()=>{const{teachers:r}=D(),{handleNavigate:a,allSubjects:l}=P(),{currentUser:o}=R(),[u,q]=i.useState(""),[h,E]=i.useState("newest"),[m,_]=i.useState("all"),[c,I]=i.useState(!1),[b,k]=i.useState(v),p=i.useRef(!1),w=i.useRef(null),L=s=>a({name:"quiz_detail_slug",slug:$(s.title)}),M=()=>a({name:"home"}),f=i.useMemo(()=>[...r.filter(t=>t.registrationStatus==="approved").flatMap(t=>t.quizzes.filter(n=>n.isPublished&&n.status!=="canceled").map(n=>F(C({},n),{teacher:t}))).filter(t=>c?!0:B(t)!=="finished").filter(t=>{if(m!=="all"&&t.subject!==m)return!1;if(u.trim()){const n=u.toLowerCase();if(![t.title,t.description,t.subject,t.teacher.name,t.teacher.id].join(" ").toLowerCase().includes(n))return!1}return!0})].sort((t,n)=>{switch(h){case"newest":return n.id.localeCompare(t.id);case"oldest":return t.id.localeCompare(n.id);case"fee_high":return n.fee-t.fee;case"fee_low":return t.fee-n.fee;case"date":default:return new Date(t.date).getTime()-new Date(n.date).getTime()}}),[r,u,h,c,m]);i.useEffect(()=>{k(v)},[u,h,c,m]);const x=i.useMemo(()=>f.slice(0,b),[f,b]),z=i.useCallback(s=>{s[0].isIntersecting&&!p.current&&(p.current=!0,k(j=>j+v))},[]);return i.useEffect(()=>{p.current=!1},[b]),i.useEffect(()=>{const s=new IntersectionObserver(z,{root:null,rootMargin:"200px",threshold:0}),d=w.current;return d&&s.observe(d),()=>{d&&s.unobserve(d)}},[z,x]),e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-slideInUp",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("button",{onClick:M,className:"flex items-center space-x-2 text-sm font-medium text-primary hover:text-primary-dark transition-colors",children:[e.jsx(H,{className:"h-5 w-5"}),e.jsx("span",{children:"Back to Home"})]})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Explore All Quizzes"}),e.jsx("p",{className:"mt-2 text-lg text-light-subtle dark:text-dark-subtle",children:"Test your knowledge with our wide range of quizzes."})]}),e.jsx("div",{className:"sticky top-16 z-20 py-4 bg-light-background/80 dark:bg-dark-background/80 backdrop-blur-sm -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 mb-8",children:e.jsxs("div",{className:"max-w-5xl mx-auto space-y-4",children:[e.jsx(U,{searchQuery:u,setSearchQuery:q}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-quizzes",className:"block text-sm font-medium text-light-text dark:text-dark-text mb-1",children:"Sort by"}),e.jsx("select",{id:"sort-quizzes",value:h,onChange:s=>E(s.target.value),className:"w-full px-3 py-2 border border-light-border dark:border-dark-border text-light-text dark:text-dark-text bg-light-surface dark:bg-dark-surface rounded-md focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",children:G.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-subject",className:"block text-sm font-medium text-light-text dark:text-dark-text mb-1",children:"Subject"}),e.jsxs("select",{id:"filter-subject",value:m,onChange:s=>_(s.target.value),className:"w-full px-3 py-2 border border-light-border dark:border-dark-border text-light-text dark:text-dark-text bg-light-surface dark:bg-dark-surface rounded-md focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",children:[e.jsx("option",{value:"all",children:"All Subjects"}),l.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{htmlFor:"include-finished",className:"text-sm font-medium",children:"Include Finished"}),e.jsx("button",{id:"include-finished",type:"button",onClick:()=>I(!c),className:`${c?"bg-primary":"bg-gray-200 dark:bg-gray-600"} relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2`,role:"switch","aria-checked":c,children:e.jsx("span",{"aria-hidden":"true",className:`${c?"translate-x-5":"translate-x-0"} pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out`})})]})})]})]})}),x.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-light-subtle dark:text-dark-subtle mb-6",children:["Showing ",x.length," of ",f.length," quizzes."]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:x.map(j=>{var t=j,{teacher:s}=t,d=Q(t,["teacher"]);return e.jsx(V,{quiz:d,teacher:s,viewMode:"public",onView:L,currentUser:o},d.id)})}),x.length<f.length&&e.jsx("div",{ref:w,className:"flex justify-center items-center h-20",children:e.jsx("div",{className:"w-8 h-8 border-4 border-dashed rounded-full animate-spin border-primary"})})]}):e.jsxs("div",{className:"text-center py-16 text-light-subtle dark:text-dark-subtle",children:[e.jsx("p",{className:"text-xl font-semibold",children:"No quizzes found"}),e.jsx("p",{children:"Try adjusting your search query or filters."})]})]})};export{se as default};
