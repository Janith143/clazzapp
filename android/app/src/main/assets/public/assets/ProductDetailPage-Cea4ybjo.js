import{r as u,j as e,l as m,C as x,a as y,u as N,e as k,d as w,aD as I,S as C,aq as P,M as T}from"./index-BXN-gaEy.js";import{u as z}from"./useSEO-BjUGcIuA.js";import{s as L}from"./slug-Be7lxzw5.js";import"./vendor-firebase-CLtQg3ae.js";const S=({images:r})=>{const[o,i]=u.useState(0),c=()=>{i(s=>s===r.length-1?0:s+1)},d=()=>{i(s=>s===0?r.length-1:s-1)};return e.jsxs("div",{className:"w-full max-w-xl mx-auto",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gray-100 dark:bg-dark-border group h-[400px]",children:[r.map((s,a)=>e.jsx("img",{src:m(s,600),alt:`Product image ${a+1}`,className:`absolute inset-0 w-full h-full object-contain transition-opacity duration-300 ease-in-out ${a===o?"opacity-100 z-10":"opacity-0 z-0"}`},a)),r.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d,className:"absolute top-1/2 left-3 -translate-y-1/2 bg-white/70 hover:bg-white text-gray-700 p-2 rounded-full shadow-lg z-20 transition-opacity opacity-50 group-hover:opacity-100","aria-label":"Previous image",children:e.jsx(x,{className:"w-6 h-6"})}),e.jsx("button",{onClick:c,className:"absolute top-1/2 right-3 -translate-y-1/2 bg-white/70 hover:bg-white text-gray-700 p-2 rounded-full shadow-lg z-20 transition-opacity opacity-50 group-hover:opacity-100","aria-label":"Next image",children:e.jsx(y,{className:"w-6 h-6"})})]})]}),r.length>1&&e.jsx("div",{className:"flex mt-3 gap-2 justify-center",children:r.map((s,a)=>e.jsx("button",{onClick:()=>i(a),className:`relative w-16 h-16 rounded-lg overflow-hidden border-2 transition-all duration-300 ease-in-out ${a===o?"border-primary":"border-transparent opacity-60 hover:opacity-100"}`,"aria-label":`Go to image ${a+1}`,children:e.jsx("img",{src:m(s,100),alt:`Thumbnail ${a+1}`,className:"object-cover w-full h-full"})},a))})]})},E=({productId:r,slug:o})=>{const{handleBack:i,handleNavigate:c}=N(),{addToCart:d}=k(),{teachers:s,loading:a}=w(),p=u.useMemo(()=>{if(r)return r;if(o&&s.length>0)for(const l of s){const h=(l.products||[]).find(v=>L(v.title)===o);if(h)return h.id}return""},[r,o,s]),{item:g,teacher:n}=I("product",p),t=g;if(z(t?t.title:"Product Details",t?t.description.substring(0,160):"View product details on clazz.lk",t&&t.coverImages&&t.coverImages.length>0?t.coverImages[0]:void 0),a)return e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-20 text-center flex flex-col items-center justify-center",children:[e.jsx(C,{className:"w-8 h-8 text-primary"}),e.jsx("p",{className:"mt-4 text-light-subtle dark:text-dark-subtle",children:"Loading product details..."})]});if(!t||!n||!("type"in t))return e.jsx("div",{children:"Product not found or has been removed."});const f=()=>{d({type:"product",product:t})},j=l=>{l.username?c({name:"teacher_profile_slug",slug:l.username}):c({name:"teacher_profile",teacherId:l.id})},b=new Intl.NumberFormat("en-LK",{style:"currency",currency:"LKR"});return e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-slideInUp",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("button",{onClick:i,className:"flex items-center space-x-2 text-sm font-medium text-primary hover:text-primary-dark transition-colors",children:[e.jsx(x,{className:"h-5 w-5"}),e.jsx("span",{children:"Back"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"rounded-lg shadow-lg overflow-hidden",children:t.coverImages&&t.coverImages.length>0?e.jsx(S,{images:t.coverImages}):e.jsx("div",{className:"flex items-center justify-center h-[400px] bg-gray-100 text-gray-500",children:"No images available"})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface p-6 rounded-lg shadow-md",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t.title}),e.jsxs("button",{onClick:()=>j(n),className:"mt-2 flex items-center space-x-2 group",children:[e.jsx("img",{src:m(n.avatar,32,32),alt:n.name,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-light-subtle dark:text-dark-subtle",children:"Created by"}),e.jsx("p",{className:"font-semibold group-hover:underline",children:n.name})]})]}),e.jsx("div",{className:"my-6",children:e.jsx("p",{className:"text-4xl font-bold text-primary",children:b.format(t.price)})}),e.jsxs("button",{onClick:f,className:"w-full flex items-center justify-center gap-2 bg-primary text-white font-bold py-3 rounded-md hover:bg-primary-dark transition-colors",children:[e.jsx(P,{className:"w-5 h-5"}),"Add to Cart"]}),e.jsxs("div",{className:"mt-6 space-y-3 text-sm border-t border-light-border dark:border-dark-border pt-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",e.jsx("span",{className:"capitalize",children:t.type})]}),t.type==="physical"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Stock:"})," ",t.stock!==void 0&&t.stock>0?`${t.stock} available`:t.stock===0?"Out of Stock":"Available"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Lead Time:"})," ",t.orderLeadTime||"Not specified"]})]})]})]})})]}),e.jsxs("div",{className:"mt-8 bg-light-surface dark:bg-dark-surface p-8 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Product Description"}),e.jsx(T,{content:t.description})]})]})};export{E as default};
