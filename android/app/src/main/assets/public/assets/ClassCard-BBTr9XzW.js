import{u as T,e as U,g as F,k as M,j as e,l as O,m as R,D as $,y as A,U as L,ai as E,aj as B,ak as _,al as z,P as W,T as K,a9 as j,Y as N}from"./index-BXN-gaEy.js";import{S as C}from"./StarRating-BeOC4AZb.js";import{s as G}from"./slug-Be7lxzw5.js";const Y=({status:t})=>{const s={scheduled:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",live:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300 animate-pulse",finished:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",canceled:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"};return e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${s[t]}`,children:t.charAt(0).toUpperCase()+t.slice(1)})},V=({classInfo:t,teacher:s,viewMode:l,enrollmentCount:a,onView:d,onEdit:c,onDelete:n,onTogglePublish:x,isOwnerView:m=!1})=>{var p,b,g,y,k;const{handleNavigate:h}=T(),{addToast:o}=U(),w=r=>{r.username?h({name:"teacher_profile_slug",slug:r.username}):h({name:"teacher_profile",teacherId:r.id})},f=r=>{r.stopPropagation();const P=`${window.location.origin}/classes/${G(t.title)}`;navigator.clipboard.writeText(P).then(()=>{o("Class link copied to clipboard!","success")}).catch(()=>{o("Failed to copy link.","error")})},v=new Intl.NumberFormat("en-LK",{style:"currency",currency:"LKR",minimumFractionDigits:0}),S=r=>{switch(r){case"Online":return e.jsx(j,{className:"w-4 h-4"});case"Physical":return e.jsx(N,{className:"w-4 h-4"});case"Both":return e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx(N,{className:"w-4 h-4"})]});default:return null}},D=new Date(t.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),i=t.isDeleted?"canceled":F(t),u=M(s.ratings);return e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface rounded-lg shadow-md overflow-hidden flex flex-col group animate-fadeIn transition-transform duration-300 hover:-translate-y-1 hover:shadow-xl",children:e.jsxs("div",{className:"p-5 flex-grow flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-primary/10 text-primary-dark dark:text-primary-light uppercase tracking-wider",children:[t.subject,t.medium&&e.jsxs("span",{className:"opacity-70 ml-1",children:["(",t.medium.charAt(0),")"]})]}),t.isFreeSlot&&e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",children:"1-on-1 Slot"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xl font-bold text-primary",children:v.format(t.fee)}),t.fee>0&&e.jsx("p",{className:"text-xs text-light-subtle dark:text-dark-subtle",children:t.weeklyPaymentOption==="per_month"?"/ month":"/ session"}),t.paymentMethod==="manual"&&e.jsx("p",{className:"text-xs font-bold text-green-600 dark:text-green-400",children:"(Pay at venue)"})]})]}),e.jsx("h3",{className:"mt-3 text-lg font-bold text-light-text dark:text-dark-text group-hover:text-primary transition-colors",children:t.title}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>w(s),className:"flex items-center space-x-2 text-sm group/teacher",children:[s.avatar?e.jsx("img",{src:O(s.avatar,32,32),alt:s.name,className:"w-6 h-6 rounded-full"}):e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary flex-shrink-0 flex items-center justify-center text-white text-xs font-bold",children:e.jsxs("span",{children:[((b=(p=s.name)==null?void 0:p.split(" ")[0])==null?void 0:b.charAt(0))||"",((y=(g=s.name)==null?void 0:g.split(" ")[1])==null?void 0:y.charAt(0))||""]})}),e.jsx("span",{className:"font-medium text-light-subtle dark:text-dark-subtle group-hover/teacher:underline",children:s.name})]}),u.count>0&&e.jsx(C,{rating:u.average,readOnly:!0,size:"xs",showLabel:!1})]}),e.jsx("p",{className:"mt-3 text-xs text-light-subtle dark:text-dark-subtle flex-grow",children:R(t.description,100)}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-light-subtle dark:text-dark-subtle",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:t.recurrence==="weekly"?`Weekly on ${q(t.date)}s`:t.recurrence==="flexible"?`${((k=t.flexibleDates)==null?void 0:k.length)||0} Sessions`:D})]}),t.recurrence!=="flexible"&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:[t.startTime," - ",t.endTime]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 mr-2 flex items-center justify-center",children:S(t.mode)}),e.jsx("span",{children:t.mode==="Both"?"Online & Physical":t.mode})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-light-border dark:border-dark-border flex flex-wrap gap-y-3 justify-between items-center",children:l==="public"?i==="canceled"&&m?e.jsx("div",{className:"w-full text-center px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 dark:text-gray-200 dark:bg-gray-800 rounded-md",children:"Canceled & Refunded to Balance"}):t.isDeleted&&!m?e.jsx("div",{className:"w-full text-center px-4 py-2 text-sm font-medium text-red-700 bg-red-100 dark:text-red-200 dark:bg-red-900/50 rounded-md",children:"Removed by teacher"}):e.jsx("button",{onClick:()=>d(t,s),className:"w-full text-center px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-primary-dark transition-colors",children:"View Details"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Y,{status:i}),!t.isPublished&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",children:"Unpublished"}),typeof a!="undefined"&&e.jsxs("div",{className:"flex items-center text-sm text-light-subtle dark:text-dark-subtle",title:`${a} enrolled students`,children:[e.jsx(L,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:a})]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[e.jsx("button",{onClick:f,className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors",title:"Share Link",children:e.jsx(E,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>d(t,s),className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors",title:"Preview Class",children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>x&&x(t.id),disabled:(a!=null?a:0)>0||i==="finished"||i==="canceled",className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:(a!=null?a:0)>0?"Cannot change publish status while students are enrolled":i!=="scheduled"?"Can only publish/unpublish scheduled classes":t.isPublished?"Unpublish this class from the website":"Make this class public on the website","aria-label":t.isPublished?"Unpublish class":"Publish class",children:t.isPublished?e.jsx(_,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>c&&c(t),className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors","aria-label":"Edit class",title:"Edit class",children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>n&&n(t.id,a||0),className:"p-2 text-red-500 hover:text-red-700 dark:hover:text-red-400 transition-colors","aria-label":"Delete class",title:(a!=null?a:0)>0?`Delete class and refund ${a} enrolled student(s).`:"Delete class",children:e.jsx(K,{className:"h-4 w-4"})})]})]})})]})})};function q(t){const s=new Date(t);return s.setMinutes(s.getMinutes()+s.getTimezoneOffset()),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][s.getDay()]}export{V as C};
