import{u as D,e as Q,k as R,h as $,j as e,l as L,D as T,y as A,U as F,ai as U,aj as z,ak as C,al as V,P as _,a2 as K,T as O}from"./index-BXN-gaEy.js";import{S as B}from"./StarRating-BeOC4AZb.js";import{s as G}from"./slug-Be7lxzw5.js";const M=({status:t})=>{const r={scheduled:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",finished:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",canceled:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"};return e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${r[t]}`,children:t.charAt(0).toUpperCase()+t.slice(1)})},X=({quiz:t,teacher:r,viewMode:n,currentUser:d,enrollmentCount:s,onView:c,onEdit:o,onManage:x,onCancel:h,onTogglePublish:m,isOwnerView:w=!1})=>{var g,f,y,k,j;const{handleNavigate:u}=D(),{addToast:b}=Q(),N=l=>{l.username?u({name:"teacher_profile_slug",slug:l.username}):u({name:"teacher_profile",teacherId:l.id})},v=l=>{l.stopPropagation();const i=`${window.location.origin}/quizzes/${G(t.title)}`;navigator.clipboard.writeText(i).then(()=>{b("Quiz link copied to clipboard!","success")}).catch(()=>{b("Failed to copy link.","error")})},I=new Intl.NumberFormat("en-LK",{style:"currency",currency:"LKR",minimumFractionDigits:0}),E=(g=d==null?void 0:d.enrolledQuizIds)==null?void 0:g.includes(t.id),p=R(r.ratings),a=$(t),S=()=>{var l,i;return n==="teacher"?e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{status:a}),!t.isPublished&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",children:"Unpublished"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:v,className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors",title:"Share Link",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>c(t),className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors",title:"Preview Quiz",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>m&&m(t.id),disabled:((l=s==null?void 0:s.newEnrollments)!=null?l:0)>0||a!=="scheduled",className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":t.isPublished?"Unpublish quiz":"Publish quiz",title:((i=s==null?void 0:s.newEnrollments)!=null?i:0)>0?"Cannot change status while students are enrolled in the current session":a!=="scheduled"?"Can only publish/unpublish scheduled quizzes":t.isPublished?"Unpublish this quiz":"Publish this quiz",children:t.isPublished?e.jsx(C,{className:"h-4 w-4"}):e.jsx(V,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>o&&o(t),disabled:a==="canceled",className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Edit quiz settings",title:a==="canceled"?"Cannot edit a canceled quiz":"Edit quiz settings",children:e.jsx(_,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>x&&x(t),disabled:a==="canceled",className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Manage questions",title:a==="canceled"?"Cannot manage questions for a canceled quiz":"Manage questions",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>h&&h(t.id),disabled:a!=="scheduled",className:"p-2 text-red-500 hover:text-red-700 dark:hover:text-red-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Cancel quiz",title:a!=="scheduled"?"Cannot cancel a quiz that is not scheduled.":"Cancel quiz & refund students",children:e.jsx(O,{className:"h-4 w-4"})})]})]}):t.isDeleted&&!w?e.jsx("div",{className:"w-full text-center px-4 py-2 text-sm font-medium text-red-700 bg-red-100 dark:text-red-200 dark:bg-red-900/50 rounded-md",children:"Removed by teacher"}):a==="canceled"?e.jsx("div",{className:"w-full text-center px-4 py-2 text-sm font-medium text-red-700 bg-red-100 dark:text-red-200 dark:bg-red-900/50 rounded-md",children:"Canceled"}):e.jsx("button",{onClick:()=>c(t),className:"w-full text-center px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-primary-dark transition-colors",children:a==="finished"?"View Results":E?"View Quiz":"View Details"})},P=new Date(t.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface rounded-lg shadow-md overflow-hidden flex flex-col group animate-fadeIn transition-transform duration-300 hover:-translate-y-1 hover:shadow-xl",children:e.jsxs("div",{className:"p-5 flex-grow flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full uppercase tracking-wider ${a!=="scheduled"?"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-300":"bg-primary/10 text-primary-dark dark:text-primary-light"}`,children:t.subject}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:`text-xl font-bold ${t.fee===0?"text-green-600 dark:text-green-400":"text-primary"}`,children:t.fee===0?"Free":I.format(t.fee)})})]}),e.jsx("h3",{className:"mt-3 text-lg font-bold text-light-text dark:text-dark-text group-hover:text-primary transition-colors",children:t.title}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>N(r),className:"flex items-center space-x-2 text-sm group/teacher",children:[r.avatar?e.jsx("img",{src:L(r.avatar,32,32),alt:r.name,className:"w-6 h-6 rounded-full"}):e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary flex-shrink-0 flex items-center justify-center text-white text-xs font-bold",children:e.jsxs("span",{children:[((y=(f=r.name)==null?void 0:f.split(" ")[0])==null?void 0:y.charAt(0))||"",((j=(k=r.name)==null?void 0:k.split(" ")[1])==null?void 0:j.charAt(0))||""]})}),e.jsx("span",{className:"font-medium text-light-subtle dark:text-dark-subtle group-hover/teacher:underline",children:r.name})]}),p.count>0&&e.jsx(B,{rating:p.average,readOnly:!0,size:"xs",showLabel:!1})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-light-subtle dark:text-dark-subtle flex-grow",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:[P," at ",t.startTime]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:[t.durationMinutes," minutes duration"]})]}),n==="teacher"&&typeof s!="undefined"&&e.jsxs("div",{className:"flex items-center",title:`${s.newEnrollments} new enrollments, ${s.totalEnrollments} total`,children:[e.jsx(F,{className:"w-4 h-4 mr-1.5"}),e.jsx("span",{className:"font-semibold",children:s.newEnrollments}),s.newEnrollments!==s.totalEnrollments&&e.jsxs("span",{className:"text-xs text-light-subtle dark:text-dark-subtle ml-1",children:["(",s.totalEnrollments," total)"]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-light-border dark:border-dark-border flex justify-between items-center",children:S()})]})})};export{X as Q};
