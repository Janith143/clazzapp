import{u as C,e as E,k as P,l as f,c as R,j as e,U,q as z,m as A,ai as T,aj as F,P as L,T as _,ak as q,al as B,y as D}from"./index-BXN-gaEy.js";import{S as O}from"./StarRating-BeOC4AZb.js";import{s as $}from"./slug-Be7lxzw5.js";const H=({course:t,teacher:s,viewMode:l,enrollmentCount:a,completionPercentage:i,onView:o,onEdit:c,onDelete:x,onTogglePublish:d,isOwnerView:k=!1})=>{var p,b,g,v;const{handleNavigate:m}=C(),{addToast:h}=E(),w=r=>{r.username?m({name:"teacher_profile_slug",slug:r.username}):m({name:"teacher_profile",teacherId:r.id})},j=r=>{r.stopPropagation();const S=`${window.location.origin}/courses/${$(t.title)}`;navigator.clipboard.writeText(S).then(()=>{h("Course link copied to clipboard!","success")}).catch(()=>{h("Failed to copy link.","error")})},y=new Intl.NumberFormat("en-LK",{style:"currency",currency:"LKR",minimumFractionDigits:0}),n=P(t.ratings),u=f(t.coverImage,400),N=R(u,[400,800]),I=()=>{if(!d)return null;if(t.adminApproval==="approved")return e.jsx("button",{onClick:()=>d(t.id),className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors","aria-label":t.isPublished?"Unpublish course":"Publish course",title:t.isPublished?"Unpublish this course":"Publish this course",children:t.isPublished?e.jsx(q,{className:"h-4 w-4"}):e.jsx(B,{className:"h-4 w-4"})});if(t.adminApproval==="pending")return e.jsxs("div",{className:"p-2 text-xs font-semibold flex items-center text-yellow-600 dark:text-yellow-400",children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),"Pending"]});const r=t.adminApproval==="rejected"?"Resubmit":"Request Publish";return e.jsx("button",{onClick:()=>d(t.id,"request_approval"),className:"px-2 py-1 text-xs font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",title:"Submit this course for admin review to be published.",children:r})};return e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface rounded-lg shadow-md overflow-hidden flex flex-col group animate-fadeIn transition-transform duration-300 hover:-translate-y-1 hover:shadow-xl",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:u||"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 225' fill='%23e2e8f0'%3E%3Crect width='400' height='225'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='sans-serif' font-size='24px' fill='%2364748b'%3ENo Image%3C/text%3E%3C/svg%3E",srcSet:N,sizes:"(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw",alt:t.title,crossOrigin:"anonymous",className:"w-full h-48 object-cover",loading:"lazy",decoding:"async",width:"400",height:"192"}),e.jsx("div",{className:"absolute top-0 right-0 bg-primary text-white text-sm font-bold px-3 py-1 m-2 rounded-md",children:y.format(t.fee)}),l==="teacher"&&!t.isPublished&&e.jsx("div",{className:"absolute top-0 left-0 bg-yellow-500 text-white text-xs font-bold px-2 py-1 m-2 rounded-md",children:"Unpublished"})]}),e.jsxs("div",{className:"p-4 flex-grow flex flex-col",children:[e.jsx("h3",{className:"text-lg font-bold text-light-text dark:text-dark-text group-hover:text-primary transition-colors",children:t.title}),e.jsxs("button",{onClick:()=>w(s),className:"mt-1 flex items-center space-x-2 text-sm group/teacher",children:[s.avatar?e.jsx("img",{src:f(s.avatar,32,32),alt:s.name,className:"w-6 h-6 rounded-full",loading:"lazy",width:"24",height:"24"}):e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary flex-shrink-0 flex items-center justify-center text-white text-xs font-bold",children:e.jsxs("span",{children:[((b=(p=s.name)==null?void 0:p.split(" ")[0])==null?void 0:b.charAt(0))||"",((v=(g=s.name)==null?void 0:g.split(" ")[1])==null?void 0:v.charAt(0))||""]})}),e.jsx("span",{className:"font-medium text-light-subtle dark:text-dark-subtle group-hover/teacher:underline",children:s.name})]}),n.count>0&&e.jsx("div",{className:"mt-2",children:e.jsx(O,{rating:n.average,count:n.count,readOnly:!0,size:"sm"})}),l==="teacher"&&typeof a!="undefined"&&e.jsxs("div",{className:"mt-2 flex items-center text-sm text-light-subtle dark:text-dark-subtle",title:`${a} enrolled students`,children:[e.jsx(U,{className:"w-4 h-4 mr-1.5"}),e.jsxs("span",{children:[a," Students Enrolled"]})]}),i!==void 0&&i>0&&e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsx(z,{value:i,max:100}),e.jsxs("p",{className:"text-xs text-right font-medium text-light-subtle dark:text-dark-subtle",children:[Math.round(i),"% Complete"]})]}),e.jsx("p",{className:"text-xs text-light-subtle dark:text-dark-subtle mt-2 flex-grow",children:A(t.description,100)})]}),e.jsx("div",{className:"p-4 pt-0 mt-auto",children:l==="public"?t.isDeleted&&!k?e.jsx("div",{className:"w-full text-center px-4 py-2 text-sm font-medium text-red-700 bg-red-100 dark:text-red-200 dark:bg-red-900/50 rounded-md",children:"Removed by teacher"}):e.jsx("button",{onClick:()=>o(t,s),className:"w-full text-center px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-primary-dark transition-colors",children:"View Course"}):e.jsxs("div",{className:"flex justify-end items-center space-x-2 border-t border-light-border dark:border-dark-border pt-3",children:[e.jsx("button",{onClick:j,className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors",title:"Share Link",children:e.jsx(T,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>o(t,s),className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors",title:"Preview Course",children:e.jsx(F,{className:"h-4 w-4"})}),I(),e.jsx("button",{onClick:()=>c&&c(t.id),className:"p-2 text-light-subtle dark:text-dark-subtle hover:text-primary dark:hover:text-primary-light transition-colors","aria-label":"Edit course",children:e.jsx(L,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>x&&x(t.id),disabled:(a!=null?a:0)>0,className:"p-2 text-red-500 hover:text-red-700 dark:hover:text-red-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Delete course",title:(a!=null?a:0)>0?"Cannot delete a course with enrolled students. Unpublish it instead to prevent new enrollments.":"Delete course",children:e.jsx(_,{className:"h-4 w-4"})})]})})]})};export{H as C};
